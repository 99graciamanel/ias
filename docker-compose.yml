version: "3.9"
services:
    web:
        build: web
        expose:
            - 8000
        environment:
            - POSTGRES_USER=web_user
            - POSTGRES_PASSWORD=GGjPs2Soo8@yk#M3
            - POSTGRES_DB=web_db
            - POSTGRES_HOST=db-web
            - POSTGRES_PORT=5432
        networks:
            - web-internal
        depends_on:
            - db-web

    db-web:
        image: "postgres:latest"
        environment:
            - POSTGRES_USER=web_user
            - POSTGRES_PASSWORD=GGjPs2Soo8@yk#M3
            - POSTGRES_DB=web_db
        volumes:
            - db-web-data:/var/lib/postgresql/data/
        ports:
            - "5432:5432"
        networks:
            - web-internal
    nginx:
        build: ./nginx
        ports:
            - 8080:8080
            - 4343:4343
        networks:
            - web-internal
        depends_on:
            - web

    
volumes: 
    db-web-data:

networks:
    web-internal:
        name: web-internal
